<?php
$pythonExecutable = '/usr/bin/python3'; // Confirm this path is correct
$currentDir = getcwd();
$pythonScriptPath = $currentDir . DIRECTORY_SEPARATOR . 'threaded_client.py';

$requiredPackages = ['requests', 'scapy'];

foreach ($requiredPackages as $package) {
    // Install packages without sudo (assuming permissions are appropriately set)
    $cmdInstallPackage = escapeshellcmd($pythonExecutable . ' -m pip install ' . $package) . ' 2>&1';
    $installOutput = shell_exec($cmdInstallPackage);
    echo "Installation output for $package: $installOutput<br>";
}

// Run the Python script with sudo
$cmdRunScript = 'sudo ' . escapeshellcmd($pythonExecutable . ' ' . $pythonScriptPath) . ' 2>&1';
$output = shell_exec($cmdRunScript);

echo "Python script executed with sudo. Output:<br>" . nl2br(htmlspecialchars($output, ENT_QUOTES, 'UTF-8'));
?>
